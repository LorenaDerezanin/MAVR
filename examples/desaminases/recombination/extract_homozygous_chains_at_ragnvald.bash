#!/usr/bin/env bash

USERDIR="/media/mahajrod/d9e6e5ee-1bf7-4dba-934e-3f898d9611c8/Data/LAN2xx/"
WORKDIR=${USERDIR}"cluster_raw_vcf_strict_FS/"

PER_SAMPLE_DIR=${WORKDIR}"per_sample_vcf/"

VCF_DIR=${WORKDIR}"per_sample_vcf/"
WORK_DIR=${WORKDIR}"homo_chains/"
MACE_DIR="/home/mahajrod/Genetics/MACE/scripts/"
SCRIPT=${MACE_DIR}"extract_homozygous_chains.py"

SAMPLE_SETS=(N010-LAN210-Can-PmCDA1-NA-RUN2-D3 N092-LAN210-Can-PmCDA1-NA-RUN7-D6 N011-LAN210-Can-PmCDA1-NA-RUN2-D3 N093-LAN210-Can-PmCDA1-NA-RUN7-D6 N012-LAN210-Can-PmCDA1-NA-RUN2-D3 N094-LAN210-Can-PmCDA1-NA-RUN7-D6 N013-LAN210-Can-PmCDA1-NA-RUN2-D3 N095-LAN210-Can-PmCDA1-NA-RUN7-D6 N034-LAN210-Can-A1-Oct12-RUN4-D3 N096-LAN210-Can-PmCDA1-NA-RUN7-D6 N035-LAN210-Can-A1-Oct12-RUN4-D3 N097-LAN210-Can-AID-NA-RUN7-D1 N036-LAN210-FOA-A1-Oct12-RUN4-D3 N098-LAN210-Can-AID-NA-RUN7-D1 N037-LAN210-FOA-A1-Oct12-RUN4-D3 N100-LAN210-Can-AID-NA-RUN7-D3 N040-LAN210-Can-AID-Oct12-RUN4-D3 N101-LAN210-Can-AID-NA-RUN7-D3 N041-LAN210-Can-AID-Oct12-RUN4-D3 N102-LAN210-Can-AID-NA-RUN7-D3 N058-LAN210-Can-PmCDA1-Feb13-RUN5-D3 N103-LAN210-Can-AID-NA-RUN7-D6 N059-LAN210-FOA-PmCDA1-Feb13-RUN5-D3 N104-LAN210-Can-AID-NA-RUN7-D6 N060-LAN210-FOA-PmCDA1-Feb13-RUN5-D3 N105-LAN210-Can-AID-NA-RUN7-D6 N061-LAN210-Can-PmCDA1-NA-RUN5-D3 N106-LAN210-Can-AID-NA-RUN7-D6 N062-LAN210-Can-PmCDA1-NA-RUN5-D3 N107-LAN210-Can-A1-NA-RUN7-D1 N065-LAN210-Can-PmCDA1-NA-RUN6-D3 N108-LAN210-Can-A1-NA-RUN7-D1 N066-LAN210-Can-PmCDA1-NA-RUN6-D3 N109-LAN210-Can-A1-NA-RUN7-D1 N070-LAN210-Can-PmCDA1-NA-RUN6-D6 N110-LAN210-Can-A1-NA-RUN7-D1 N071-LAN210-Can-PmCDA1-NA-RUN6-D6 N111-LAN210-Can-A1-NA-RUN7-D1 N072-LAN210-Can-PmCDA1-NA-RUN6-D6 N112-LAN210-Can-A1-NA-RUN7-D1 N073-LAN210-Can-PmCDA1-NA-RUN6-D6 N113-LAN210-Can-A1-NA-RUN7-D3 N077-LAN210-Can-AID-NA-RUN6-D6 N114-LAN210-Can-A1-NA-RUN7-D3 N078-LAN210-Can-AID-NA-RUN6-D6 N115-LAN210-Can-A1-NA-RUN7-D3 N079-LAN210-Can-A1-NA-RUN6-D6 N116-LAN210-Can-A1-NA-RUN7-D3 N080-LAN210-Can-A1-NA-RUN6-D6 N117-LAN210-Can-A1-NA-RUN7-D3 N085-LAN210-Can-PmCDA1-NA-RUN7-D1 N118-LAN210-Can-A1-NA-RUN7-D3 N086-LAN210-Can-PmCDA1-NA-RUN7-D1 N120-LAN210-Can-A1-NA-RUN7-D6 N087-LAN210-Can-PmCDA1-NA-RUN7-D1 N121-LAN210-Can-A1-NA-RUN7-D6 N088-LAN210-Can-PmCDA1-NA-RUN7-D1 N122-LAN210-Can-A1-NA-RUN7-D6 N089-LAN210-Can-PmCDA1-NA-RUN7-D1 N123-LAN210-Can-A1-NA-RUN7-D6 N090-LAN210-Can-PmCDA1-NA-RUN7-D1 N124-LAN210-Can-A1-NA-RUN7-D6 N091-LAN210-Can-PmCDA1-NA-RUN7-D3)

mkdir -p ${WORK_DIR}
cd ${WORK_DIR}
mkdir -p all/ vcf/ ccf/ hist/ svg/ gff/
cd all/

for SAMPLE in ${SAMPLE_SETS[@]};
    do
    VCF_FILE=${VCF_DIR}${SAMPLE}".vcf"
    ${SCRIPT} -i ${VCF_FILE} -o ${SAMPLE}"_homozygous_chains"
    done

for FORMAT in vcf ccf hist svg gff;
    do
    /usr/bin/env cp -f  *.${FORMAT} ../${FORMAT}/
    done
